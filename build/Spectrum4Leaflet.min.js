/*! Spectrum4Leaflet 29-01-2015 */
var Spectrum4Leaflet={Version:"0.1",Services:{}};"undefined"!=typeof window&&window.L&&(window.L.spectrum4L=Spectrum4Leaflet),Spectrum4Leaflet.Util={},Spectrum4Leaflet.Request={_createRequest:function(a,b){var c=new XMLHttpRequest;return c.onerror=function(){a.call(b,{error:{code:500,message:"XMLHttpRequest error"}},null)},c.onreadystatechange=function(){var d,e;if(4===c.readyState){try{d=JSON.parse(c.responseText)}catch(f){d=null,e={code:500,message:"Could not parse response as JSON."}}!e&&d.error&&(e=d.error,d=null),a.call(b,e,d)}},c},get:function(a,b,c){var d=this._createRequest(b,c);return d.open("GET",a,!0),d.send(null),d},post:function(a,b,c,d){var e=this._createRequest(c,d);return e.open("POST",a,!0),e.setRequestHeader("Content-Type","application/json"),e.send(b),e}},Spectrum4Leaflet.Services.Operation=L.Class.extend({options:{name:"",getParams:{},postParams:{},forcePost:!1,paramsSeparator:";"},initialize:function(a,b){b=b||{},b.name=a,L.Util.setOptions(this,b)},getUrlQuery:function(){var a=[],b=this.options.getParams;for(var c in b)if(b.hasOwnProperty(c)){var d=b[c];a.push(c+"="+d)}var e=this.options.name;return a.length>0&&(e+=";"+a.join(this.options.paramsSeparator)),e},getPostData:function(){return JSON.stringify(this.options.postParams)},isPostOperation:function(){return 0!==Object.keys(this.options.postParams).length|this.options.forcePost}}),Spectrum4Leaflet.Services.Service=L.Class.extend({options:{},initialize:function(a,b){b=b||{},b.url=a,L.Util.setOptions(this,b)},startRequest:function(a,b,c){var d="/"===this.options.url.slice(-1)?"":"/",e=this.options.url+d+a.getUrlQuery();return a.isPostOperation()?Spectrum4Leaflet.Request.post(e,a.getPostData(),b,c):Spectrum4Leaflet.Request.get(e,b,c)}}),Spectrum4Leaflet.Services.MapService=Spectrum4Leaflet.Services.Service.extend({listNamedLayers:function(a,b,c){var d=new Spectrum4Leaflet.Services.Operation("layers.json");a&&(d.options.getParams.l=a),this.startRequest(d,b,c)}});